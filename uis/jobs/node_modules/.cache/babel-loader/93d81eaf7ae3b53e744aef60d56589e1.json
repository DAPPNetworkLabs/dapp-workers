{"ast":null,"code":"import Web3 from 'web3';\nimport NexusJSON from '../../abi/Nexus.json';\nconst jobs = [];\nconst web3 = new Web3('http://localhost:8545');\nconst contractAddress = \"0x94D387F50569200aDACFd903345D077ef6ABcE11\";\nconst contract = new web3.eth.Contract(NexusJSON.abi, contractAddress);\n\nconst fetchJobs = async thisObject => {\n  console.log(contract);\n  const lastJob = await contract.methods.lastJobID().call();\n\n  for (let i = 0; i < lastJob; i++) {\n    const job = await contract.methods.jobs(i).call();\n    jobs.push(job);\n  }\n\n  console.log(jobs);\n  thisObject.setState({\n    jobs: JSON.stringify(jobs)\n  });\n};\n\nconst runJob = async form => {\n  console.log(form);\n  const lastJob = await contract.methods.run(form.consumer, form.imageName, form.inputFS, form.args).call({\n    from: consumer\n  });\n  await contract.events.Run({}, function (error, event) {\n    console.log(error);\n    console.log(event);\n  });\n};\n\nexport default {\n  fetchJobs,\n  runJob\n};","map":{"version":3,"sources":["/Users/natanaelprudhomme/Workspaces/dapp-workers/uis/jobs/src/lib/web3/index.js"],"names":["Web3","NexusJSON","jobs","web3","contractAddress","contract","eth","Contract","abi","fetchJobs","thisObject","console","log","lastJob","methods","lastJobID","call","i","job","push","setState","JSON","stringify","runJob","form","run","consumer","imageName","inputFS","args","from","events","Run","error","event"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,SAAP,MAAsB,sBAAtB;AAEA,MAAMC,IAAI,GAAG,EAAb;AACA,MAAMC,IAAI,GAAG,IAAIH,IAAJ,CAAS,uBAAT,CAAb;AACA,MAAMI,eAAe,GAAG,4CAAxB;AACA,MAAMC,QAAQ,GAAG,IAAIF,IAAI,CAACG,GAAL,CAASC,QAAb,CAAsBN,SAAS,CAACO,GAAhC,EAAoCJ,eAApC,CAAjB;;AAEA,MAAMK,SAAS,GAAG,MAAOC,UAAP,IAAsB;AACpCC,EAAAA,OAAO,CAACC,GAAR,CAAYP,QAAZ;AACA,QAAMQ,OAAO,GAAG,MAAMR,QAAQ,CAACS,OAAT,CAAiBC,SAAjB,GAA6BC,IAA7B,EAAtB;;AACA,OAAI,IAAIC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAGJ,OAAjB,EAA0BI,CAAC,EAA3B,EAA+B;AAC3B,UAAMC,GAAG,GAAG,MAAMb,QAAQ,CAACS,OAAT,CAAiBZ,IAAjB,CAAsBe,CAAtB,EAAyBD,IAAzB,EAAlB;AACAd,IAAAA,IAAI,CAACiB,IAAL,CAAUD,GAAV;AACH;;AACDP,EAAAA,OAAO,CAACC,GAAR,CAAYV,IAAZ;AACAQ,EAAAA,UAAU,CAACU,QAAX,CAAoB;AAAClB,IAAAA,IAAI,EAAEmB,IAAI,CAACC,SAAL,CAAepB,IAAf;AAAP,GAApB;AACH,CATD;;AAWA,MAAMqB,MAAM,GAAG,MAAOC,IAAP,IAAgB;AAC3Bb,EAAAA,OAAO,CAACC,GAAR,CAAYY,IAAZ;AACA,QAAMX,OAAO,GAAG,MAAMR,QAAQ,CAACS,OAAT,CAAiBW,GAAjB,CAAqBD,IAAI,CAACE,QAA1B,EAAoCF,IAAI,CAACG,SAAzC,EAAoDH,IAAI,CAACI,OAAzD,EAAkEJ,IAAI,CAACK,IAAvE,EAA6Eb,IAA7E,CAAkF;AACpGc,IAAAA,IAAI,EAACJ;AAD+F,GAAlF,CAAtB;AAGA,QAAMrB,QAAQ,CAAC0B,MAAT,CAAgBC,GAAhB,CAAoB,EAApB,EAAwB,UAASC,KAAT,EAAgBC,KAAhB,EAAsB;AAChDvB,IAAAA,OAAO,CAACC,GAAR,CAAYqB,KAAZ;AACAtB,IAAAA,OAAO,CAACC,GAAR,CAAYsB,KAAZ;AACH,GAHK,CAAN;AAIH,CATD;;AAWA,eAAe;AACXzB,EAAAA,SADW;AAEXc,EAAAA;AAFW,CAAf","sourcesContent":["import Web3 from 'web3';\nimport NexusJSON from '../../abi/Nexus.json';\n\nconst jobs = [];\nconst web3 = new Web3('http://localhost:8545');\nconst contractAddress = \"0x94D387F50569200aDACFd903345D077ef6ABcE11\";\nconst contract = new web3.eth.Contract(NexusJSON.abi,contractAddress);\n\nconst fetchJobs = async (thisObject) => {\n    console.log(contract);\n    const lastJob = await contract.methods.lastJobID().call();\n    for(let i=0; i < lastJob; i++) {\n        const job = await contract.methods.jobs(i).call();\n        jobs.push(job);\n    }\n    console.log(jobs);\n    thisObject.setState({jobs: JSON.stringify(jobs)});\n}\n\nconst runJob = async (form) => {\n    console.log(form)\n    const lastJob = await contract.methods.run(form.consumer, form.imageName, form.inputFS, form.args).call({\n        from:consumer\n    });\n    await contract.events.Run({}, function(error, event){\n        console.log(error);\n        console.log(event); \n    });\n}\n\nexport default { \n    fetchJobs,\n    runJob\n}"]},"metadata":{},"sourceType":"module"}